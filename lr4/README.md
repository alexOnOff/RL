# Лабораторная работа №4. 
## Методы Монте-Карло
### Обсуждение.Оценивание ценности состояний (предcказание или оценивание стратегии ради ценности состояний)

*1.  Опираясь на рисунок рассмотренной стратегии игры агента в блэкджек, попробуйте ответить на вопросы:*

  *Почему оценка функции ценности резко возрастает в последних двух делениях на задней части графика (когда сумма очков у агента $19-21$)?*
  *Почему она спадает в последней левой строке на диаграммах (когда у крупье открытая карта - туз)?*
  *Почему значения на переднем плане на верхних диаграммах выше, чем на нижних?*



*2.  Будет ли разница в результатах, если вместо МК первого посещения выбрать метод МК всех посещений и почему? Запрограммируйте оба алгоритма и сравните их оценки на одной стратегии.*




### Обсуждение.Вариант Монте-Карло классической итерации по стратегиям (управление)

*1.  В алгоритм метода Монте-Карло ИС для оптимизации следует вместо хранения всех доходов хранить только среднее доходов и количество элементов в списке (для каждой пары состояние–действие) и обновлять их инкрементно. Такой подход описан в разделе Инкрементной реализации методички Многоруких бандитов.*




### Обсуждение.Вариант Монте-Карло без исследовательских стартов (управление)

1.   Поворот гоночной трассы. Гонщик хочет научится проходить повороты как можно быстрее, но при этом не вылетать с трассы. **<font color='orange'>Наложим на трассу для удобства сетку</font>**. В каждый момент времени автомобиль с гонщиком может находиться в одной из дискретных ячеек этой сетки.

  **<font color='orange'>Скорость</font>** дискретна и равна количеству ячеек, на которые машина переместилась по горизонтали и по вертикали за один временной шаг. **<font color='orange'>Действиями</font>** в задаче будут приращения составляющих скорости в промежутке $[-1; 1]$ с шагом $1$ (т.к. направления у скорости два, то **<font color='orange'>действий всего будет девять $(3*3)$</font>**). **<font color='orange'>Награда</font>** за каждый шаг $R = -1$.
  
  **<font color='orange'>Обе составляющие скорости должны быть неотрицательны и меньше 5, и одновременно могут быть равны 0 только на линии старта.</font>**
  
  Каждый **<font color='orange'>эпизод</font>** начинается в одном из случайно выбранных **<font color='orange'>начальных состояний</font>** (скорость $= (0,0)$), а заканчивается, когда машина пересечет **<font color='orange'>линию финиша</font>**. **<font color='orange'>Если машина задела границу трассы, то она возвращается в случайную позицию на линии старта</font>** со скоростью $= (0,0)$, **<font color='orange'>и эпизод продолжается</font>**. Прежде чем обновлять положение машины на каждом шаге, следует **<font color='orange'>проверить, не вылетела ли она за пределы трассы</font>**.

  Примените к этой задаче метод управления Монте-Карло для вычисления оптимальной стратегии при старте из каждого начального состояния. Выведите несколько траекторий, следующих оптимальной стратегии.




2.   **<font color='orange'>На основе задачи о гоночной трассе</font>**: с вероятностью 0.1 на каждом временном шаге оба приращения, составляющих скорости, равны нулю независимо от того, какими они должны были бы стать.

  Примечание: при выведении траекторий, следующих оптимальной стратегии, шум нужно отключить, иначе рандомные переключения скорости остануться.


